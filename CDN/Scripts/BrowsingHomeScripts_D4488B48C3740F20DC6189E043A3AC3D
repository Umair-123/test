Vista.Home=function(){function i(){$.ajax({url:Vista.Urls.Home.NowShowing,type:"POST",success:function(i){n($("#home-now-showing"),i,t)}}),$.ajax({url:Vista.Urls.Home.ComingSoon,type:"POST",success:function(t){t.length?n($("#home-coming-soon"),t,r):$("#home-coming-soon").hide().prev("h2").hide()}})}function n(n,t,i){var u=n.find(".scrollbox-view"),r;for(u.empty(),n.removeClass("container-loading"),r=0;r<t.length;r++)Vista.Utilities.fixDotNetJsonDateString(t[r]),u.append(Vista.Utilities.format(i,t[r].Id,t[r].PosterImageUrl,t[r].Title,t[r].Rating,Globalize.format(t[r].ReleaseDate,"d")));n.scrollbox("refresh")}var t='<a href="'+Vista.Urls.Home.MovieDetails+'{0}" class="movie"><img class="movie-poster" src="'+Vista.Urls.Home.MovieImage+'&height=500" alt="{2}" /><span class="name"><img src="'+Vista.Urls.Home.RatingImage+'" alt="{3}" />{2}</span><span>'+Vista.Lang.Home.BuyTickets+"</span></a>",r='<a href="'+Vista.Urls.Home.MovieDetails+'{0}" class="movie"><img class="movie-poster" src="'+Vista.Urls.Home.MovieImage+'&height=500" alt="{2}" /><span class="name"><img src="'+Vista.Urls.Home.RatingImage+'" alt="{3}" />{2}</span><span>{4} | '+Vista.Lang.Home.MoreInfo+"</span></a>";return{init:function(){$(".home-movies").scrollbox();var t=$("#home-center-ad"),n=$("#home-sidebar-ad");Vista.Images.AdvertImages(t,"Home","CenterBanner"),Vista.Images.AdvertImages(n,"Home","Gallery"),i()}}}(),$(Vista.Home.init),Vista.Loyalty.SignInWidget=function(){"use strict";var i=$(".sign-in-help"),t=$(".js-sign-in-help-toggle");return{init:function(){t.on("click",function(n){return n.preventDefault(),i.slideToggle(150),!1})}}}(),$(Vista.Loyalty.SignInWidget.init),Vista.GiftCards.GiftCardBalanceInquiry=function(){"use strict";function y(){f=$(".gift-card-balance-inquiry-presentational-state"),o=$(".gift-card-balance-inquiry-inquiry-state"),n=$(".gift-card-balance-inquiry-result-state"),e=$(".gift-card-balance-inquiry-loading-state"),s=$(".gift-card-balance-inquiry-form"),r=s.find("#CardNumber"),c=$(".check-another-card-button"),u=$(".error-container")}function p(){$(".gift-card-balance-inquiry-presentational-state").click(function(){i(t.inquiryForm)}),c.click(function(){v(),i(t.inquiryForm),a()}),s.submit(function(){return i(t.loading),$.ajax({type:"POST",url:s.attr("action"),data:{giftCardNumber:r.val()}}).done(function(u){if(!u.succeeded){h(Vista.Lang.GiftCardBalanceInquiry.GeneralError),i(t.inquiryForm);return}n.find(".gift-card-number").text(r.val()),n.find(".gift-card-balance").text(Vista.FormatUtilities.formatCurrency(u.balanceInCents,!0)),u.cardExpiryDate!==null?(n.find(".gift-card-expiry").text(u.cardExpiryDate),n.find(".gift-card-expiry-result-line").removeClass("not-applicable")):n.find(".gift-card-expiry-result-line").addClass("not-applicable"),i(t.results)}).fail(function(){h(Vista.Lang.GiftCardBalanceInquiry.GeneralError),i(t.inquiryForm)}),!1}),r.focusin(function(){l()})}function w(){}function i(i){switch(i){case t.presentational:f.removeClass("not-applicable"),o.addClass("not-applicable"),n.addClass("not-applicable"),e.addClass("not-applicable");break;case t.inquiryForm:f.addClass("not-applicable"),o.removeClass("not-applicable"),n.addClass("not-applicable"),e.addClass("not-applicable");break;case t.results:f.addClass("not-applicable"),o.addClass("not-applicable"),n.removeClass("not-applicable"),e.addClass("not-applicable");break;case t.loading:f.addClass("not-applicable"),o.addClass("not-applicable"),n.addClass("not-applicable"),e.removeClass("not-applicable");break;default:throw Error("Unknown state: "+i+" for gift card inquiry control.");}}function v(){r.val(null)}function a(){n.find(".gift-card-number").text(""),n.find(".gift-card-balance").text(""),n.find(".gift-card-expiry").text("")}function h(n){u.find(".error-text").text(n),u.removeClass("not-applicable")}function l(){u.find(".error-text").text(""),u.addClass("not-applicable")}var t={presentational:0,inquiryForm:1,results:2,loading:3},f,o,n,e,s,r,c,u;return{init:function(){y(),w(),p()}}}(),$(Vista.GiftCards.GiftCardBalanceInquiry.init),$(function(){$("body").prepend('<div id="fb-root"></div>'),function(n,t,i){var r,u=n.getElementsByTagName(t)[0];n.getElementById(i)||(r=n.createElement(t),r.id=i,r.src="//connect.facebook.net/en_US/all.js",u.parentNode.insertBefore(r,u))}(document,"script","facebook-jssdk")}),Vista.SocialMedia.Facebook=function(){"use strict";return{init:function(n){n.fbAsyncInit=function(){FB.init({status:!0,xfbml:!0})}},bindLikeButtonClick:function(n){var t=window.fbAsyncInit;if(typeof window.fbAsyncInit!="function")throw new Error("The function fbAsyncInit is not initialised. You must call Vista.SocialMedia.Facebook.init before using this function");window.fbAsyncInit=function(){t(),FB.Event.subscribe("edge.create",n)}}}}(),Vista.SocialMedia.Facebook.init(window),Vista.SocialMedia.Twitter=function(){"use strict";var n;return{init:function(t){t.twttr=function(n,i,r){var e,u,f=n.getElementsByTagName(i)[0];if(!n.getElementById(r))return u=n.createElement(i),u.id=r,u.src="//platform.twitter.com/widgets.js",f.parentNode.insertBefore(u,f),t.twttr||(e={_e:[],ready:function(n){e._e.push(n)}})}(document,"script","twitter-wjs"),t.twttr.ready(function(t){typeof n=="function"&&t.events.bind("tweet",n)})},bindTweetButtonClick:function(t){typeof window.twttr!="function"?n=t:twttr.events.bind("tweet",t)}}}(),$(Vista.SocialMedia.Twitter.init(window))